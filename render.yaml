services:
  - type: web
    name: business-loan-backend
    env: node
    region: oregon
    plan: free
    buildCommand: npm ci && npm run build && npm run render:seed
    startCommand: npm run start:prod
    healthCheckPath: /api/staff/health
    autoDeploy: true
    envVars:
      - key: NODE_ENV
        value: production
      - key: RENDER
        value: true
      - key: PORT
        value: 5002
      # SendGrid Configuration (Primary Email Service)
      # IMPORTANT: Replace with your actual SendGrid API key from https://app.sendgrid.com/settings/api_keys
      - key: SENDGRID_API_KEY
        value: YOUR_SENDGRID_API_KEY_HERE
      # IMPORTANT: This email MUST be verified in SendGrid at https://app.sendgrid.com/settings/sender_auth
      # Using gokrishna98@gmail.com - MUST be verified in SendGrid dashboard
      - key: SENDGRID_FROM_EMAIL
        value: gokrishna98@gmail.com
      # Gmail SMTP Configuration (Fallback)
      - key: GMAIL_EMAIL
        value: gokrishna98@gmail.com
      - key: GMAIL_APP_PASSWORD
        value: wwigqdrsiqarwiwz
      # Supabase Configuration
      - key: SUPABASE_URL
        value: https://vxtpjsymbcirszksrafg.supabase.co
      - key: SUPABASE_ANON_KEY
        value: eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJzdXBhYmFzZSIsInJlZiI6InZ4dHBqc3ltYmNpcnN6a3NyYWZnIiwicm9sZSI6ImFub24iLCJpYXQiOjE3NTk3MzY0NjAsImV4cCI6MjA3NTMxMjQ2MH0.ZYI75xNjBEhjrZb6jyxzS13BSo2oFzidPz6KdAlRvpU
      # JWT Configuration
      - key: JWT_SECRET
        value: business-loan-jwt-secret-key-production-2024
      # Backend URL for email links
      - key: BACKEND_URL
        value: https://business-loan-backend.onrender.com
      # Database Configuration
      - key: DATABASE_URL
        value: file:./dev.db
      - key: PRISMA_QUERY_ENGINE_LIBRARY
        value: /opt/render/project/src/node_modules/.prisma/client/libquery_engine-linux-musl-openssl-3.0.x.so.node
